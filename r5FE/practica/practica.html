<!DOCTYPE html>
<!--
To change this license header, choose License Headers in Project Properties.
To change this template file, choose Tools | Templates
and open the template in the editor.
-->
<html>
    <head>
        <title>TODO supply a title</title>
        <script src="js/libreria.js"></script>
        <script src="js/datos.js"></script>        
        <script src="js/info_acad.js"></script>
        <script src="js/exp_pro.js"></script>
        <script src="js/cursos_re.js"></script>

        <script src="js/checks.js"></script>
        <script src="js/valida_datos_personales.js"></script>
        <script src="js/validar_info_acad.js"></script>
        <script src="js/validar_exp.js"></script>
        <script src="js/validar_cursos.js"></script>
        <script src="js/validar_idioma.js"></script>
        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" lang="es-es">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
    </head>
    <body>
        <form >
            <fieldset>
                <legend>Datos Personales</legend>

                <label>Nombre y Apellidos<input id="nombre_y_ap" type="text"/></label>
                <label>Dirección<input type="text" id="direccion" /></label>

                <label>Ciudad<select id="ciudad"  onmouseout="carga_poblaciones();">
                        <option id="c1">Almería</option>          
                        <option id="c2">Granada</option>          
                        <option id="c3">Málaga</option>          
                    </select></label>
                <label>Población

                    <select id="select_poblaciones" onclick="escribe_cp();">

                    </select></label>
                <label>Código Postal<input id="cp" type="text"/></label>
                <label>Telefonos<input type="text" id="telefono" /></label>
                <label>Correo Electronico<input type="text" id="correo"/></label>
                <label>Fecha de Nacimiento<input type="date" id="fnac"/></label>
                <label>Lugar de Nacimiento<input type="text" id="lnac"/></label>
                <div>
                    <label>Estado Civil
                        <select id="s_estado">
                            <option selected>Soltero</option>
                            <option>Casado</option>
                            <option>Separado</option>
                            <option>Viudo</option>
                        </select>
                    </label>
                </div>
            </fieldset>  
            <button type="button" onclick="fvalida_datos_personales();">Comprueba</button>
            <p id="error_dt"></p>
            <fieldset id="finfo_acad"> 
                <!-sdfgsfgsdfgsg-->
                <legend>Información Académica</legend>
                <div>
                    <label>Sin estudios<input id="check_estudios" type="checkbox" onclick="click_check_studios()"/></label>
                    <label>Nombre de la Institución<input id="nombre_acad" type="text"/></label>
                    <label>Titulo Obtenido<input id="titulo_obt" type="text"/></label>
                    <label>Fecha Comienzo<input id="fi_acad" type="date"/></label>
                    <label>Fecha Fin<input id="ff_acad" type="date"/></label>
                    <div>
                        <label>Comentarios</label></div>
                    <div>
                        <textarea rows="4" cols="50" id="coment_acad"></textarea>
                    </div>
                </div>                
                <button type="button" onclick="nuevo_merito()">Nuevo Merito</button>
                <button type="button" onclick="fvalida_info_acad()">Comprueba</button>
            </fieldset>
            <p id="error_info_acad"></p>
            <fieldset id="exp_prof">
                <legend >Experiencia Profesional</legend>
                <div>
                    <label>Sin experiencia profesional<input id="check_exp" type="checkbox" onclick="click_check_exp_prof();"/></label>
                    <label>Empresa<input id="empresa" type="text"/></label>
                    <label>Puesto<input id="puesto" type="text"/></label>
                    <div>
                        <label>Fecha Inicio<input id="fi_exp" type="date"/></label>
                        <label>Fecha Fin<input id="ff_exp" type="date"/></label>
                    </div>
                    <div>
                        <label>Descripcion del Puesto
                            <input id="desc_puesto_exp" type="text"/></label></div>
                    <div>
                        <label>Tareas Realizadas</label></div>
                    <div>
                        <textarea rows="4" cols="50" id="tareas_r_exp" ></textarea>
                    </div>                    
                    <label>Logros Conseguidos</label>
                    <div>
                        <textarea rows="4" cols="50" id="logros_exp"></textarea>
                    </div>
                    <button type="button" onclick="nueva_exp_prof();">Nueva experiencia</button>
                    <button type="button" onclick="f_validar_exp();">Comprueba</button>
                </div>
            </fieldset>
            <p id="error_exp_prof"></p>
            <fieldset id="cr">
                <legend>Cursos Realizados</legend>
                <div>
                    <label>Ningun curso<input type="checkbox" id="ch_cursos" onclick="click_check_cursos_realizados();"/></label>
                    <label>Nombre<input id="nombre_curso" type="text"/></label>
                    <label>Institución<input id="inst_curso" type="text"/></label>
                    <div>
                        <label>Fecha Inicio<input id="fi_curso" type="date"/></label>
                        <label>Fecha Fin<input id="ff_curso" type="date"/></label>
                    </div>
                    <label>Titulo Obtenido<input id="to_curso" type="text"/></label>
                </div>
                <button type="button" onclick="nuevo_curso();" >Nuevo curso</button>
                <button type="button" onclick="f_validar_cursos();">Comprueba</button>
            </fieldset>
            <p id="error_cursos_r"></p>
            <fieldset id="fidimoas" >
                <legend id="s_idiomas" >Idiomas</legend>
                <div>
                    <label>Idioma</label>
                    <select id="idioma" >                       
                    </select>
                    <label>Nivel</label>
                    <select  id="nivel_idioma">                        
                    </select>
                </div>
                <button type="button" onclick="nuevo_idioma();">Nuevo Idioma</button>
                <button type="button" onclick="f_validar_idm();">Comprueba</button>
            </fieldset>
            <p id="error_idiomas"></p>
            <fieldset>
                <legend>Conocimientos adicionales</legend>
                <label>Descripcion</label>
                <div><textarea  id="conoc_add" rows="8" cols="100"></textarea></div>
            </fieldset>
            <fieldset>
                <legend>Hobbies y actividades de interés particulares</legend>

                <label>Descripcion</label>
                <div><textarea id="hobbies" rows="8" cols="100"></textarea></div>
            </fieldset>
            <fieldset>
                <legend>Carta de Presentación</legend>
                <input id="fichero" type="file" onchange="processFiles(this.files);"/>
                <div>
                    <textarea  disabled id="contenido_fichero" rows="8" cols="100"></textarea></div>
            </fieldset>
            <p id="error_carta_presentacion"></p>
            <button type="button" onclick="f_valida_Fichero();"  >Comprobar</button>
            <div>
                <button type="button" onclick="Comprobar_General();"  >Comprobar Todo</button>
                <button type="submit"  >Enviar</button>
            </div>
        </form>
        <script>


            function imprime_array(a)
            {
                var cad = "";
                if (isArray(a))
                {
                    for (var i = 0; i < a.length; i++)
                    {
                        cad += a[i] + " ";
                    }
                } else
                    cad += a + " ";
                return cad;
            }

            function Comprobar_General()
            {

                var cad = "";
                cad += "<br><b>Datos personales :</b>" + "\n";
                cad += imprime_array(fvalida_datos_personales()) + "\n";
                cad += "<br><b>Información academica :</b>" + "\n";
                cad += imprime_array(fvalida_info_acad()) + "\n";
                cad += "<br><b>Experiencia Profesional :</b>" + "\n";
                cad += imprime_array(f_validar_exp()) + "\n";
                cad += "<br><b>Cursos Realizados :</b>" + "\n";
                cad += imprime_array(f_validar_cursos()) + "\n";
                cad += "<br><b>Idiomas :</b>" + "\n";


                cad += imprime_array(f_validar_idm()) + "\n";
                cad += "<br><b>Conocimientos adicionales:</b>" + "\n";
                cad += document.getElementById("conoc_add").value + "\n";
                cad += "<br><b>Hobbies y actividades de interés particulares:</b>" + "\n";
                cad += document.getElementById("hobbies").value + "\n";
                cad += "<br><b>Carta de Presentación:</b>" + "\n";
                cad += imprime_array(f_valida_Fichero()) + "\n";

                var myWindow = window.open("", "myWindow", "width=600, height=600");
                myWindow.document.write("<p>" + cad + "</p>");
                //myWindow.opener.document.write("<p>This is the source window!</p>");

                //alert(cad);

            }

            function f_valida_Fichero()
            {
                var hay_fichero;
                var f = document.getElementById("fichero");
                if (f.files.length >= 1)
                {
                    hay_fichero = true;
                } else
                {
                    hay_fichero = false;
                }
                if (!hay_fichero)
                {
                    document.getElementById("error_carta_presentacion").innerHTML = "No has seleccionado fichero de carta de presentación";
                }

                r = [];
                if (hay_fichero)
                {
                    r.push(true);
                    r.push("Nombre de fichero :" + f.files[0].name);
                    r.push("Contenido:\n" + document.getElementById("contenido_fichero").value);

                }
                return r;

            }

            function f_validar_cursos()
            {
                var d = [];
                var v = [];

                d.push(document.getElementById("nombre_curso").value);
                d.push(document.getElementById("inst_curso").value);
                d.push(document.getElementById("fi_curso").value);
                d.push(document.getElementById("ff_curso").value);
                d.push(document.getElementById("to_curso").value);

                v.push(validar_nombre_curso(d[0]));
                v.push(validar_institucion(d[1]));
                var f1 = d[2];
                var f2 = d[3];
                //alert(f1);
                v.push(validar_intervalo_fechas(f1, f2));
                v.push(validar_titulo(d[4]));

                var campos = ["Nombre Curso",
                    "Institución",
                    "Fechas de Comienzo y de Fin",
                    "Titulo Obtenido"];
                var cadena = "";
                var otracadena = "";
                for (var i = 0; i < campos.length; i++)
                {
                    if (!v[i])
                    {
                        otracadena += campos[i] + " no es correcto<br>";
                    }
                    cadena = cadena + "\n" + campos[i] + " " + v[i];
                }
                // alert(cadena);
                document.getElementById("error_cursos_r").innerHTML = otracadena;


                if (otracadena.length === 0)
                {

                    return d;
                }
                return false;
            }

            function f_validar_exp()
            {
                var d = [];
                var v = [];

                d.push(document.getElementById("empresa").value);
                d.push(document.getElementById("puesto").value);
                d.push(document.getElementById("fi_exp").value);
                d.push(document.getElementById("ff_exp").value);
                d.push(document.getElementById("desc_puesto_exp").value);
                d.push(document.getElementById("tareas_r_exp").value);
                d.push(document.getElementById("logros_exp").value);

                v.push(validar_nombre_exp(d[0]));
                v.push(validar_puesto_exp(d[1]));
                var f1 = d[2];
                var f2 = d[3];
                //alert(f1);
                v.push(validar_intervalo_fechas(f1, f2));
                v.push(validar_descripcion_puesto(d[4]));
                v.push(validar_tareas_real(d[5]));
                v.push(validar_logros(d[6]));

                var campos = ["Empresa",
                    "Puesto",
                    "Fechas de Comienzo y de Fin",
                    "Descripcion puesto",
                    "Tareas Realizadas",
                    "Logros Conseguidos"];
                var cadena = "";
                var otracadena = "";
                for (var i = 0; i < campos.length; i++)
                {
                    if (!v[i])
                    {
                        otracadena += campos[i] + " no es correcto<br>";
                    }
                    cadena = cadena + "\n" + campos[i] + " " + v[i];
                }
                //alert(cadena);
                document.getElementById("error_exp_prof").innerHTML = otracadena;
                var r = [];
                if (otracadena.length === 0)
                {

                    r.push(d);
                }
                return r;
            }

            function fvalida_info_acad()
            {
                var d = [];
                var v = [];

                d.push(document.getElementById("nombre_acad").value);
                d.push(document.getElementById("titulo_obt").value);
                d.push(document.getElementById("fi_acad").value);
                d.push(document.getElementById("ff_acad").value);
                d.push(document.getElementById("coment_acad").value);

                //alert(document.getElementById("nombre_acad").value);
                v.push(validar_nombre_institucion(d[0]));
                v.push(validar_titulo(d[1]));
                var f1 = d[2];
                var f2 = d[3];
                v.push(validar_intervalo_fechas(f1, f2));
                v.push(validar_comentarios(d[4]));




                var campos = ["Nombre de la Institución",
                    "Titulo Obtenido",
                    "Fechas de Comienzo y de Fin",
                    "Comentarios"];
                var cadena = "";
                var otracadena = "";

                for (var i = 0; i < campos.length; i++)
                {
                    if (!v[i])
                    {
                        otracadena += campos[i] + " no es correcto<br>";
                    }
                    cadena = cadena + "\n" + campos[i] + " " + v[i];
                }
                //alert(cadena);
                document.getElementById("error_info_acad").innerHTML = otracadena;

                var r = [];
                if (otracadena.length === 0)
                {

                    r.push(d);

                }
                //imprime_array(d);
                return r;
            }

            function fvalida_datos_personales()
            {
                var d = []; // para datos
                var v = [];//para validacion


                d.push(document.getElementById("nombre_y_ap").value);
                d.push(document.getElementById("direccion").value);
                d.push(document.getElementById("ciudad").value);
                var indice = document.getElementById("select_poblaciones").selectedIndex;
                d.push(document.getElementById("select_poblaciones").options[indice].value);
                d.push(document.getElementById("cp").value);
                d.push(document.getElementById("telefono").value);
                d.push(document.getElementById("correo").value);
                d.push(document.getElementById("fnac").value);
                d.push(document.getElementById("lnac").value);
                var indice = document.getElementById("s_estado").selectedIndex;
                d.push(document.getElementById("s_estado").options[indice].value);

                v.push(validar_nombres(d[0]));//
                //alert (1);
                v.push(validar_direccion(d[1]));//
                //ciudad poblcaiom cp
                v.push(validar_ciudad(d[2]));
                v.push(validar_poblacion(d[3]));
                v.push(validar_cp(d[4]));
                //alert (2);
                v.push(validaTelefono(d[5]));//
                //alert (3);
                v.push(validar_correo_electronico(d[6]));
                //alert (4);
                v.push(valida_fecha_nacimiento(d[7]));//
                //alert (5);
                v.push(validar_lugar_nacimiento(d[8]));//
                //alert (6);
                v.push(validar_estado_civil(d[9]));
                //alert (7);

                var campos = ["nombre", "direccion", "ciudad", "poblacion", "cp", "telefono", "correo", "fecha", "lugar de nacimiento", "estado civil"];

                var cadena = "";
                var otracadena = "";


                for (var i = 0; i < campos.length; i++)
                {
                    if (v[i] === false)
                    {
                        otracadena += campos[i] + " no es correcto<br>";
                    }
                    cadena = cadena + campos[i] + " " + v[i] + "\n";
                }

                document.getElementById("error_dt").innerHTML = otracadena;
                var r = [];

                if (otracadena.length === 0)
                {

                    return d;

                }

                return false;
            }

            function f_validar_idm()
            {

                nuevo_idioma();
                document.getElementById("error_idiomas").innerHTML = "";

                var d = [];
                d.push(Aidiomas);
                d.push(AnivelI);


                var e = validar(Aidiomas, AnivelI);


                if (e === 0)
                    document.getElementById("error_idiomas").innerHTML = "Debes introducir al menos un idioma";
                if (e === 1)
                    document.getElementById("error_idiomas").innerHTML = "Uno de los idiomas debe ser nivel nativo";


                if ((e !== 0) && (e !== 1))
                {
                    var r = [];
                    for (var i = 0; i < Aidiomas.length; i++)
                    {
                        r.push(Aidiomas[i] + " - " + AnivelI[i] + ";");
                        
                    }

                    return(r);
                }
                return false;
            }

            function escribe_cp()
            {
                var caja = document.getElementById("cp");
                var select = document.getElementById("select_poblaciones");
                var options = select.getElementsByTagName("option");
                //alert (options.length);
                var i = 0;
                while (options[i].selected !== true)
                    i++;

                var v = cargar_codigos_postales(recupera_ciudad());
                //alert(vcp[n].split(":")[0]);
                //caja.innerHTML=vcp[n].split(":")[0];
                caja.value = v[options[i].value].split(":")[0];
                //alert(event.type);
            }

            function carga_poblaciones()
            {
                var select = document.getElementById("select_poblaciones");
                borra_poblaciones();
                var element;
                var ciudad = recupera_ciudad();
                //alert(recupera_ciudad());
                var cpob = cargar_codigos_postales(ciudad);
                // alert (cpob);
                for (var i = 0; i < cpob.length; i++)
                {
                    element = document.createElement("option");

                    element.value = i;
                    element.innerHTML = cpob[i].split(":")[1];

                    //element.addEventListener("onselect", "escribe_cp();", true);
                    select.appendChild(element);
                }
                //alert("Número de inserciones :"+cpob.length);
            }

            function recupera_ciudad()
            {
                var c1 = document.getElementById("c1");
                var c2 = document.getElementById("c2");
                var c3 = document.getElementById("c3");
                if (c1.selected === true)
                {
                    return c1.innerHTML;
                }
                if (c2.selected === true)
                {
                    return c2.innerHTML;
                }
                if (c3.selected === true)
                {
                    return c3.innerHTML;
                }

            }

            function borra_poblaciones()
            {
                var select = document.getElementById("select_poblaciones");
                //var options=select.getElementsByTagName("option");
                //alert ("Elementos con tag option en select de poblaciones :"+options.length);


                while (select.hasChildNodes())
                {
                    select.removeChild(select.firstChild);
                }
                //alert ("option"+options.length);
            }

            carga_idiomas();
            carga_niveles();
        </script>
    </body>
</html>
